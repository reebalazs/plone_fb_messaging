<h2>Activity Stream <span ng-clock>({{visibleActivities | streamLength}})</h2>
<div>
</div>

<p></p>
<div class="activities" id="activitiesDiv" auto-scroll="visibleActivities">
    <details class="activity" ng-cloak ng-repeat="activity in visibleActivities">
      <summary>
        <strong>Message:</strong> {{activity.message}}
        <div>
          <div><strong>User ID:</strong> {{activity.userID}}</div>
          <div><strong>Change Time:</strong> {{activity.time | date:'medium'}}</div>
        </div>
      </summary>
      <div class="details">
        <div class="description" ng-if="activity.description"><strong>Description:</strong> {{activity.description}}</div>
        <div class="changes" id="changesDiv">
          <div ng-cloak ng-repeat="change in activity.changes">
            <span ng-switch="$first && Object.keys(activity.changes).length == 1">
              <details ng-switch-when="true" class="change" open>
                <summary>
                  <strong>Change Message:</strong> {{change.message}}
                </summary>
                <div class="details">
                  <div><strong>Object UID:</strong> {{change.uid}}</div>
                  <div><strong>Event Type:</strong> {{change.eventType}}</div>
                  <div class="description" ng-if="change.description"><strong>Change Description:</strong> {{change.description}}</div>
                </div>
              </details>

              <details ng-switch-default class="change">
                <summary>
                  <strong>Change Message:</strong> {{change.message}}
                </summary>
                <div class="details">
                  <div><strong>Object UID:</strong> {{change.uid}}</div>
                  <div><strong>Event Type:</strong> {{change.eventType}}</div>
                  <div class="description" ng-if="change.description"><strong>Change Description:</strong> {{change.description}}</div>
                </div>
              </details>
            </span>
          </div>
        </div>
      </div>
    </details>
  </div>
  
  Show All: <input type="checkbox" ng-model="showAll" ng-click="toggleShow()" ng-true-value="true" ng-false-value="false"><br/>
  <button ng-click="markSeen()">Mark All as Read</button>