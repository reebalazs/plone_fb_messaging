<div id="fb-overlay" class="overlay overlay-ajax"  
    ><!--tal:define="auth_token python: view.auth_token;"
    tal:attributes="ng-init string:firebase_url = '${view/data/firebase_url}';; auth_token = '${auth_token}';; plone_username='${view/auth_data/ploneUsername}';;
      "-->
  <div class="close fb-close"></div>
  <div class="fb-overlay-content">
    <ul class="navbar">
      <li><a class="nav" href="#/activity">Activity Stream</a></li>
      <li><a class="nav" href="#/messaging">Messaging</a></li>
    </ul>
    <h1><a href="/">Command Central</a></h1>
    <div ng-view></div>
  </div>
</div>
<script type="text/javascript">
  var root_id = 'fb-overlay';

  // Add me to the end of the body. Fixes z-index issue.
  // Make sure this all takes place before angular starts to kick in.
  jQuery('#' + root_id).appendTo('body');
  
  // Boot the angular app
  // (we don't need ng-app in this case, which allows us to
  // coexist with more apps in the same page)
  angular.bootstrap(document.getElementById(root_id), ['commandCentral']);

  // Overlay creation for Plone
  jQuery(function ($) {

    var $overlay = $('#' + root_id);

    $overlay.overlay({
    });

    // global helper function to show the overlay
    window.showFbOverlay = function() {
        $overlay.overlay().load();
    };

    $overlay.find('.fb-close').click(function (evt) {
        $overlay.overlay().close();
        return false;
    });

});
</script>
